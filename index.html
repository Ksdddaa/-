<!DOCTYPE html>  
<html lang="zh-CN">  
<head>  
<meta charset="UTF-8">  
<meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">  
<meta name="apple-mobile-web-app-capable" content="yes">  
<title>æ…¢æ…¢é è¿‘ä½ </title>  
  
<style>  
html,body{  
  margin:0;  
  padding:0;  
  height:100%;  
  overflow:hidden;  
  font-family:-apple-system,BlinkMacSystemFont,"PingFang SC","Helvetica Neue",sans-serif;  
  background:radial-gradient(circle at top,#1a1d3a,#0b0d1c);  
  color:#fff;  
}  
*{box-sizing:border-box}  
  
canvas{  
  position:fixed;  
  inset:0;  
  z-index:0;  
}  
  
.stage{  
  position:absolute;  
  inset:0;  
  display:flex;  
  align-items:center;  
  justify-content:center;  
  padding:30px;  
  z-index:2;  
}  
.panel{  
  max-width:380px;  
  text-align:center;  
}  
  
.line{  
  font-size:17px;  
  line-height:2.2;  
  opacity:0;  
  transition:opacity 1.8s ease;  
}  
.line.show{opacity:1}  
  
.name{  
  margin-top:26px;  
  font-size:26px;  
  color:#ffb7cc;  
  letter-spacing:2px;  
  opacity:0;  
  transition:opacity 2s ease;  
}  
  
button{  
  margin-top:36px;  
  padding:14px 36px;  
  border-radius:40px;  
  border:none;  
  background:#ff7fa8;  
  color:#fff;  
  font-size:15px;  
  box-shadow:0 0 40px rgba(255,127,168,.8);  
}  
button:active{transform:scale(.96)}  
  
.hint{  
  position:absolute;  
  bottom:28px;  
  font-size:13px;  
  opacity:.55;  
}  
</style>  
</head>  
  
<body>  
  
<canvas id="bg"></canvas>  
  
<div class="stage">  
  <div class="panel">  
    <div class="line" id="text"></div>  
    <div class="name" id="name">å°å§š</div>  
    <button id="btn" style="display:none" onclick="next()">æˆ‘æƒ³å’Œä½ è¯´å¥è¯</button>  
  </div>  
  <div class="hint">è½»è½»ç‚¹ä¸€ä¸‹</div>  
</div>  
  
<audio id="bgm" loop>  
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_84c2bfa8a5.mp3">  
</audio>  
  
<script>  
/* =========================  
   ğŸ” å›çœ‹æ¨¡å¼çŠ¶æ€  
========================= */  
const HAS_VIEWED_KEY = "confession_viewed";  
const isReturning = localStorage.getItem(HAS_VIEWED_KEY) === "yes";  
  
/* =========================  
   æ˜Ÿäº‘èƒŒæ™¯  
========================= */  
const c=document.getElementById("bg");  
const ctx=c.getContext("2d");  
function resize(){c.width=innerWidth;c.height=innerHeight}  
resize();addEventListener("resize",resize);  
  
let warm=false;  
const fog=Array.from({length:260},()=>({  
  x:Math.random()*c.width,  
  y:Math.random()*c.height,  
  r:Math.random()*2.4+0.6,  
  v:Math.random()*0.12+0.04,  
  o:Math.random()*0.6+0.3  
}));  
  
function draw(){  
  ctx.clearRect(0,0,c.width,c.height);  
  fog.forEach(p=>{  
    ctx.beginPath();  
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2);  
    ctx.fillStyle= warm  
      ? `rgba(255,185,205,${p.o})`  
      : `rgba(255,255,255,${p.o})`;  
    ctx.fill();  
    p.y+=p.v;  
    if(p.y>c.height) p.y=0;  
  });  
  requestAnimationFrame(draw);  
}  
draw();  
  
/* =========================  
   å…­å¹•ç« èŠ‚  
========================= */  
const chapters = [  
  
[  
  ...(isReturning ? [  
    "ä½ åˆçœ‹åˆ°è¿™é‡Œäº†ã€‚",  
    "<br><br>",  
    "é‚£æˆ‘æƒ³ï¼Œ",  
    "ä¹Ÿè®¸è¿™äº›è¯ï¼Œ",  
    "å¯¹ä½ æ¥è¯´å¹¶ä¸é™Œç”Ÿã€‚",  
    "<br><br>",  
    "æ‰€ä»¥è¿™ä¸€æ¬¡ï¼Œ",  
    "æˆ‘ä¼šè¯´å¾—æ…¢ä¸€ç‚¹ã€‚"  
  ] : [  
    "æœ‰äº›è¯ï¼Œ",  
    "ä¸å¤ªé€‚åˆåœ¨èŠå¤©æ¡†é‡Œè¯´ã€‚",  
    "<br><br>",  
    "ä¸æ˜¯å› ä¸ºä¸é‡è¦ï¼Œ",  
    "æ°æ°ç›¸åï¼Œ",  
    "æ˜¯å› ä¸ºå¤ªè®¤çœŸäº†ã€‚",  
    "<br><br>",  
    "è®¤çœŸåˆ°æˆ‘ä¼šåå¤æ€è€ƒï¼Œ",  
    "è¦ä¸è¦è¯´å‡ºå£ã€‚"  
  ])  
],  
  
[  
"åæ¥æœ‰ä¸€æ®µæ—¶é—´ï¼Œ",  
"æˆ‘å¼€å§‹ç•™æ„å¾ˆå¤šç»†èŠ‚ã€‚",  
"<br><br>",  
"ä¸€äº›åŸæœ¬å¾ˆæ™®é€šçš„ç¬é—´ï¼Œ",  
"å› ä¸ºä½ åœ¨ï¼Œ",  
"å˜å¾—å€¼å¾—è®°ä½ã€‚",  
"<br><br>",  
"æˆ‘ä¼šåœ¨äº‹æƒ…å‘ç”Ÿä¹‹åï¼Œ",  
"ä¸‹æ„è¯†åœ°æƒ³èµ·ä½ ã€‚",  
"<br><br>",  
"ç„¶åæ‰æ„è¯†åˆ°ï¼Œ",  
"è¿™ç§ä¹ æƒ¯ï¼Œ",  
"å·²ç»å­˜åœ¨äº†ä¸€æ®µæ—¶é—´ã€‚"  
],  
  
[  
"è¿™ç§å˜åŒ–å¹¶ä¸åµé—¹ã€‚",  
"<br><br>",  
"å®ƒæ²¡æœ‰æ‰“ä¹±æˆ‘çš„ç”Ÿæ´»ï¼Œ",  
"å´æ…¢æ…¢æ”¹å˜äº†æˆ‘çš„é‡å¿ƒã€‚",  
"<br><br>",  
"æˆ‘å¼€å§‹æœŸå¾…ä¸€äº›å¯¹è¯ï¼Œ",  
"ä¹Ÿå¼€å§‹åœ¨æ„ä½ çš„æƒ…ç»ªã€‚",  
"<br><br>",  
"ä¸æ˜¯åˆ»æ„çš„é‚£ç§åœ¨æ„ï¼Œ",  
"è€Œæ˜¯å¾ˆè‡ªç„¶åœ°ï¼Œ",  
"æƒ³é è¿‘ä¸€ç‚¹ã€‚"  
],  
  
[  
"æˆ‘æƒ³è¿‡å¾ˆå¤šç§è¡¨è¾¾æ–¹å¼ã€‚",  
"<br><br>",  
"æœ€åè¿˜æ˜¯é€‰æ‹©äº†ç°åœ¨è¿™æ ·ã€‚",  
"<br><br>",  
"ä¸æ€¥ç€å®šä¹‰ï¼Œ",  
"ä¹Ÿä¸æ€¥ç€ç´¢å–ã€‚",  
"<br><br>",  
"åªæ˜¯æŠŠæˆ‘çš„å¿ƒæ„ï¼Œ",  
"å®‰é™åœ°æ”¾åœ¨ä½ é¢å‰ã€‚"  
],  
  
[  
"ç›´åˆ°æœ‰ä¸€å¤©ï¼Œ",  
"æˆ‘æ„è¯†åˆ°ï¼Œ",  
"è¿™å¹¶ä¸æ˜¯å¶ç„¶ã€‚",  
"<br><br>",  
"ä¸æ˜¯å› ä¸ºæ—¶é—´åˆšå¥½ï¼Œ",  
"è€Œæ˜¯å› ä¸ºä½ ã€‚",  
"<br><br>",  
"ä½ è¿™ä¸ªäººï¼Œ",  
"æœ¬èº«å°±å¾ˆé‡è¦ã€‚"  
],  
  
[  
"æˆ‘ä¸æ€¥ç€è¦ä¸€ä¸ªç»“æœã€‚",  
"<br><br>",  
"åªæ˜¯æƒ³è®©ä½ çŸ¥é“â€”â€”",  
"<br><br>",  
"åœ¨æˆ‘çš„ä¸–ç•Œé‡Œï¼Œ",  
"ä½ æœ‰ä¸€ä¸ªå¾ˆæ¸©æŸ”çš„ä½ç½®ã€‚"  
]  
  
];  
  
/* =========================  
   ä¸»çº¿æ’­æ”¾  
========================= */  
let scene=0, idx=0;  
const box=document.getElementById("text");  
const name=document.getElementById("name");  
const btn=document.getElementById("btn");  
  
function play(){  
  box.classList.add("show");  
  box.innerHTML+=chapters[scene][idx++];  
  if(idx<chapters[scene].length){  
    setTimeout(play, isReturning ? 1100 : 800);  
  }else{  
    if(scene<chapters.length-1){  
      setTimeout(()=>{  
        box.innerHTML="";  
        idx=0;  
        scene++;  
        play();  
      },1800);  
    }else{  
      setTimeout(()=>{  
        name.style.opacity=1;  
        btn.style.display="inline-block";  
        localStorage.setItem(HAS_VIEWED_KEY,"yes");  
      },2000);  
    }  
  }  
}  
  
/* =========================  
   å¯åŠ¨  
========================= */  
let started=false;  
document.body.addEventListener("click",()=>{  
  if(!started){  
    document.getElementById("bgm").play();  
    play();  
    started=true;  
  }  
});  
  
/* =========================  
   æœ€ç»ˆæŒ‰é’®  
========================= */  
function next(){  
  warm=true;  
  box.innerHTML="";  
  name.style.opacity=0;  
  btn.style.display="none";  
  
  const end=[  
    "ä½ å¯¹æˆ‘æ¥è¯´ï¼Œ",  
    "æ˜¯ä¸€ç§å¾ˆå®‰é™çš„åœ¨æ„ã€‚",  
    "<br><br>",  
    "å¦‚æœä½ æ„¿æ„ï¼Œ",  
    "è·Ÿæˆ‘è¯´ä¸€å¥è¯å°±å¥½ã€‚",  
    "<br>",  
    "æˆ‘ä¼šè®¤çœŸå¬ã€‚"  
  ];  
  let j=0;  
  function endShow(){  
    if(j<end.length){  
      box.innerHTML+=end[j++];  
      setTimeout(endShow,900);  
    }  
  }  
  endShow();  
}  
  
/* =========================  
   ğŸŒ™ æ·±å¤œå½©è›‹  
========================= */  
(function(){  
  const now=new Date();  
  const hour=now.getHours();  
  let shown=false;  
  
  const egg=document.createElement("div");  
  egg.style.position="fixed";  
  egg.style.bottom="18px";  
  egg.style.left="50%";  
  egg.style.transform="translateX(-50%)";  
  egg.style.fontSize="13px";  
  egg.style.opacity="0";  
  egg.style.color="rgba(255,255,255,.55)";  
  egg.style.transition="opacity 2s";  
  egg.style.zIndex="5";  
  egg.style.textAlign="center";  
  egg.innerHTML="å·²ç»å¾ˆæ™šäº†ã€‚<br>å¦‚æœä½ è¿˜åœ¨çœ‹ï¼Œå¸Œæœ›ä½ ä»Šå¤©è¿‡å¾—è¿˜ä¸é”™ã€‚";  
  
  document.body.appendChild(egg);  
  
  function show(){  
    if(shown) return;  
    shown=true;  
    egg.style.opacity="1";  
  }  
  
  if(hour>=23||hour<5){  
    setTimeout(show,3000);  
  }else{  
    setTimeout(show,40000);  
  }  
  
  egg.addEventListener("click",()=>{  
    egg.style.opacity="0";  
    setTimeout(()=>{  
      box.innerHTML="";  
      const night=[  
        "å…¶å®è¿™äº›è¯ï¼Œ",  
        "æ›´é€‚åˆåœ¨å®‰é™çš„å¤œæ™šçœ‹åˆ°ã€‚",  
        "<br><br>",  
        "å¦‚æœç°åœ¨ä½ æœ‰ä¸€ç‚¹ç‚¹ç©ºé—²ï¼Œ",  
        "é‚£å°±åˆšåˆšå¥½ã€‚",  
        "<br><br>",  
        "æ™šå®‰ä¹‹å‰ï¼Œ",  
        "å¦‚æœä½ æ„¿æ„ï¼Œ",  
        "è·Ÿæˆ‘è¯´ä¸€å¥è¯å§ã€‚"  
      ];  
      let i=0;  
      function showN(){  
        if(i<night.length){  
          box.innerHTML+=night[i++];  
          setTimeout(showN,900);  
        }  
      }  
      showN();  
    },1200);  
  });  
})();  
</script>  
  
</body>  
</html>  
